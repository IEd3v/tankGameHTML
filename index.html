<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Танк-динозавр: Объезжай препятствия!</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Press Start 2P', cursive;
            background: linear-gradient(to bottom, #87CEEB, #E0F6FF);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow: hidden;
            padding: 10px;
            color: #333;
            touch-action: manipulation;
        }
        
        .container {
            width: 100%;
            max-width: 500px;
            text-align: center;
        }
        
        header {
            margin-bottom: 20px;
            padding: 15px;
            background-color: rgba(0, 0, 0, 0.7);
            border-radius: 15px;
            color: white;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            border: 4px solid #8B4513;
        }
        
        h1 {
            font-size: 22px;
            margin-bottom: 10px;
            color: #FFD700;
            text-shadow: 2px 2px 0 #8B4513;
        }
        
        .score-container {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
            font-size: 16px;
        }
        
        #game-container {
            position: relative;
            width: 100%;
            height: 250px;
            overflow: hidden;
            background-color: #8B7355;
            border-radius: 10px;
            border: 6px solid #5D4037;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
            margin-bottom: 15px;
        }
        
        #game-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        
        #ground {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 25px;
            background-color: #654321;
            z-index: 1;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 10px;
        }
        
        .btn {
            padding: 12px 20px;
            font-family: 'Press Start 2P', cursive;
            font-size: 12px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 5px 0 #2E7D32;
        }
        
        .btn:active {
            transform: translateY(5px);
            box-shadow: 0 0px 0 #2E7D32;
        }
        
        .btn-restart {
            background-color: #f44336;
            box-shadow: 0 5px 0 #c62828;
        }
        
        .game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            z-index: 10;
            display: none;
            border: 5px solid #FFD700;
            width: 90%;
            max-width: 300px;
        }
        
        .game-over h2 {
            color: #FFD700;
            margin-bottom: 15px;
            font-size: 20px;
        }
        
        .game-over p {
            margin-bottom: 15px;
            font-size: 14px;
        }
        
        .start-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.85);
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 20;
            padding: 20px;
            text-align: center;
        }
        
        .start-screen h2 {
            color: #FFD700;
            margin-bottom: 15px;
            font-size: 22px;
        }
        
        .start-screen p {
            margin-bottom: 10px;
            font-size: 12px;
            line-height: 1.5;
        }
        
        .tap-to-start {
            margin-top: 20px;
            color: #4CAF50;
            font-size: 16px;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 0.5; }
            50% { opacity: 1; }
            100% { opacity: 0.5; }
        }
        
        .tank {
            position: absolute;
            bottom: 25px;
            left: 50px;
            width: 50px;
            height: 30px;
            z-index: 5;
            transition: bottom 0.2s;
        }
        
        .tank-body {
            position: absolute;
            width: 50px;
            height: 22px;
            background-color: #556B2F;
            border-radius: 4px;
            bottom: 0;
        }
        
        .tank-turret {
            position: absolute;
            width: 30px;
            height: 12px;
            background-color: #6B8E23;
            border-radius: 3px;
            top: -8px;
            left: 10px;
        }
        
        .tank-barrel {
            position: absolute;
            width: 25px;
            height: 6px;
            background-color: #2F4F4F;
            border-radius: 2px;
            top: 2px;
            left: 40px;
        }
        
        .tank-tracks {
            position: absolute;
            width: 54px;
            height: 10px;
            background-color: #2F4F4F;
            border-radius: 3px;
            bottom: -4px;
            left: -2px;
        }
        
        .obstacle {
            position: absolute;
            bottom: 25px;
            width: 25px;
            height: 25px;
            z-index: 4;
        }
        
        .mine {
            background-color: #333;
            border-radius: 50%;
            box-shadow: inset 0 0 10px #FF0000;
        }
        
        .rock {
            background-color: #808080;
            border-radius: 8px 8px 0 0;
        }
        
        .enemy-tank {
            width: 40px;
            height: 28px;
            background-color: #8B0000;
            border-radius: 4px;
        }
        
        .cloud {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 50px;
            z-index: 2;
        }
        
        @media (max-width: 480px) {
            h1 {
                font-size: 18px;
            }
            
            #game-container {
                height: 220px;
            }
            
            .btn {
                padding: 10px 15px;
                font-size: 11px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ТАНК-ДИНОЗАВР</h1>
            <div class="score-container">
                <div>Счёт: <span id="score">0</span></div>
                <div>Рекорд: <span id="high-score">0</span></div>
            </div>
        </header>
        
        <div id="game-container">
            <canvas id="game-canvas"></canvas>
            <div id="ground"></div>
            
            <div class="start-screen" id="start-screen">
                <h2>ТАНК-ДИНОЗАВР</h2>
                <p>Нажмите на экран или пробел, чтобы прыгнуть</p>
                <div class="tap-to-start">НАЖМИТЕ, ЧТОБЫ НАЧАТЬ</div>
            </div>
            
            <div class="game-over" id="game-over">
                <h2>ТАНК ПОДБИТ!</h2>
                <p>Ваш счёт: <span id="final-score">0</span></p>
                <p>Рекорд: <span id="final-high-score">0</span></p>
                <button class="btn btn-restart" id="restart-btn">ИГРАТЬ СНОВА</button>
            </div>
        </div>
        
        <div class="controls">
            <button class="btn" id="jump-btn">ПРЫГАТЬ</button>
            <button class="btn btn-restart" id="start-btn">СТАРТ</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Элементы игры
            const canvas = document.getElementById('game-canvas');
            const ctx = canvas.getContext('2d');
            const gameContainer = document.getElementById('game-container');
            const startScreen = document.getElementById('start-screen');
            const gameOverScreen = document.getElementById('game-over');
            const scoreElement = document.getElementById('score');
            const highScoreElement = document.getElementById('high-score');
            const finalScoreElement = document.getElementById('final-score');
            const finalHighScoreElement = document.getElementById('final-high-score');
            const startBtn = document.getElementById('start-btn');
            const restartBtn = document.getElementById('restart-btn');
            const jumpBtn = document.getElementById('jump-btn');
            
            // Установка размеров canvas
            function resizeCanvas() {
                canvas.width = gameContainer.clientWidth;
                canvas.height = gameContainer.clientHeight;
            }
            
            resizeCanvas();
            window.addEventListener('resize', resizeCanvas);
            
            // Игровые переменные
            let game = {
                speed: 5,
                score: 0,
                highScore: localStorage.getItem('tankDinoHighScore') || 0,
                isRunning: false,
                isJumping: false,
                jumpVelocity: 0,
                gravity: 0.6, // Увеличена гравитация для более низкого прыжка
                groundLevel: 25,
                obstacles: [],
                clouds: [],
                lastObstacleTime: 0,
                obstacleInterval: 2000,
                gameLoopId: null
            };
            
            // Позиция танка
            const tank = {
                x: 50,
                y: 0,
                width: 50,
                height: 30,
                color: '#556B2F'
            };
            
            // Инициализация игры
            function initGame() {
                game.score = 0;
                game.speed = 5;
                game.isRunning = true;
                game.isJumping = false;
                game.jumpVelocity = 0;
                game.obstacles = [];
                game.clouds = [];
                game.lastObstacleTime = 0;
                game.obstacleInterval = 2000;
                
                tank.y = canvas.height - game.groundLevel - tank.height;
                
                // Создаем несколько облаков
                for (let i = 0; i < 5; i++) {
                    game.clouds.push({
                        x: Math.random() * canvas.width,
                        y: Math.random() * (canvas.height / 3),
                        width: 60 + Math.random() * 60,
                        height: 30 + Math.random() * 30,
                        speed: 0.5 + Math.random() * 1
                    });
                }
                
                // Обновляем отображение счета
                highScoreElement.textContent = game.highScore;
                scoreElement.textContent = game.score;
                
                // Скрываем экраны
                startScreen.style.display = 'none';
                gameOverScreen.style.display = 'none';
                
                // Запускаем игровой цикл
                if (game.gameLoopId) {
                    cancelAnimationFrame(game.gameLoopId);
                }
                game.gameLoopId = requestAnimationFrame(gameLoop);
            }
            
            // Игровой цикл
            function gameLoop(timestamp) {
                if (!game.isRunning) return;
                
                // Очистка canvas
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                // Рисуем фон (небо)
                ctx.fillStyle = '#87CEEB';
                ctx.fillRect(0, 0, canvas.width, canvas.height - game.groundLevel);
                
                // Рисуем облака
                drawClouds();
                
                // Рисуем землю
                ctx.fillStyle = '#654321';
                ctx.fillRect(0, canvas.height - game.groundLevel, canvas.width, game.groundLevel);
                
                // Рисуем траву на земле
                ctx.fillStyle = '#7CFC00';
                ctx.fillRect(0, canvas.height - game.groundLevel, canvas.width, 3);
                
                // Обновляем и рисуем танк
                updateTank();
                drawTank();
                
                // Обновляем и рисуем препятствия
                updateObstacles(timestamp);
                drawObstacles();
                
                // Проверяем столкновения
                checkCollisions();
                
                // Обновляем счет
                updateScore();
                
                // Увеличиваем сложность
                increaseDifficulty();
                
                // Продолжаем игровой цикл
                game.gameLoopId = requestAnimationFrame(gameLoop);
            }
            
            // Рисуем облака
            function drawClouds() {
                game.clouds.forEach(cloud => {
                    // Перемещаем облако
                    cloud.x -= cloud.speed;
                    
                    // Если облако ушло за левый край, перемещаем его вправо
                    if (cloud.x + cloud.width < 0) {
                        cloud.x = canvas.width;
                        cloud.y = Math.random() * (canvas.height / 3);
                    }
                    
                    // Рисуем облако
                    ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
                    ctx.beginPath();
                    ctx.ellipse(cloud.x + cloud.width/2, cloud.y + cloud.height/2, cloud.width/2, cloud.height/2, 0, 0, Math.PI * 2);
                    ctx.fill();
                });
            }
            
            // Обновляем состояние танка
            function updateTank() {
                // Применяем гравитацию, если танк в прыжке
                if (game.isJumping) {
                    tank.y += game.jumpVelocity;
                    game.jumpVelocity += game.gravity;
                    
                    // Если танк упал на землю
                    if (tank.y >= canvas.height - game.groundLevel - tank.height) {
                        tank.y = canvas.height - game.groundLevel - tank.height;
                        game.isJumping = false;
                        game.jumpVelocity = 0;
                    }
                }
            }
            
            // Рисуем танк
            function drawTank() {
                // Корпус танка
                ctx.fillStyle = '#556B2F';
                ctx.fillRect(tank.x, tank.y + 8, tank.width, tank.height - 8);
                
                // Башня
                ctx.fillStyle = '#6B8E23';
                ctx.fillRect(tank.x + 8, tank.y, 30, 10);
                
                // Пушка
                ctx.fillStyle = '#2F4F4F';
                ctx.fillRect(tank.x + 38, tank.y + 4, 20, 5);
                
                // Гусеницы
                ctx.fillStyle = '#2F4F4F';
                ctx.fillRect(tank.x - 2, tank.y + tank.height - 4, tank.width + 4, 8);
                
                // Колеса гусениц
                ctx.fillStyle = '#000';
                for (let i = 0; i < 5; i++) {
                    ctx.beginPath();
                    ctx.arc(tank.x + (i * 10) + 5, tank.y + tank.height, 3, 0, Math.PI * 2);
                    ctx.fill();
                }
            }
            
            // Прыжок танка - уменьшена начальная скорость прыжка
            function jump() {
                if (!game.isJumping && game.isRunning) {
                    game.isJumping = true;
                    game.jumpVelocity = -10; // Было -15, теперь -10 для более низкого прыжка
                }
            }
            
            // Создаем препятствие
            function createObstacle() {
                const types = ['mine', 'rock', 'enemy-tank'];
                const type = types[Math.floor(Math.random() * types.length)];
                
                let width, height;
                
                switch(type) {
                    case 'mine':
                        width = 25;
                        height = 25;
                        break;
                    case 'rock':
                        width = 35;
                        height = 25;
                        break;
                    case 'enemy-tank':
                        width = 40;
                        height = 28;
                        break;
                }
                
                game.obstacles.push({
                    x: canvas.width,
                    y: canvas.height - game.groundLevel - height,
                    width: width,
                    height: height,
                    type: type
                });
            }
            
            // Обновляем препятствия
            function updateObstacles(timestamp) {
                // Создаем новое препятствие, если прошло достаточно времени
                if (timestamp - game.lastObstacleTime > game.obstacleInterval) {
                    createObstacle();
                    game.lastObstacleTime = timestamp;
                    
                    // Случайным образом уменьшаем интервал для следующего препятствия
                    game.obstacleInterval = Math.max(800, 2000 - game.score * 10);
                }
                
                // Перемещаем препятствия и удаляем те, что ушли за левый край
                game.obstacles = game.obstacles.filter(obstacle => {
                    obstacle.x -= game.speed;
                    return obstacle.x + obstacle.width > 0;
                });
            }
            
            // Рисуем препятствия
            function drawObstacles() {
                game.obstacles.forEach(obstacle => {
                    switch(obstacle.type) {
                        case 'mine':
                            // Мина
                            ctx.fillStyle = '#333';
                            ctx.beginPath();
                            ctx.arc(obstacle.x + obstacle.width/2, obstacle.y + obstacle.height/2, obstacle.width/2, 0, Math.PI * 2);
                            ctx.fill();
                            
                            // Красный индикатор на мине
                            ctx.fillStyle = '#FF0000';
                            ctx.beginPath();
                            ctx.arc(obstacle.x + obstacle.width/2, obstacle.y + obstacle.height/2, obstacle.width/4, 0, Math.PI * 2);
                            ctx.fill();
                            break;
                            
                        case 'rock':
                            // Камень
                            ctx.fillStyle = '#808080';
                            ctx.beginPath();
                            ctx.ellipse(obstacle.x + obstacle.width/2, obstacle.y + obstacle.height/2, obstacle.width/2, obstacle.height/2, 0, 0, Math.PI * 2);
                            ctx.fill();
                            
                            // Текстура камня
                            ctx.fillStyle = '#696969';
                            ctx.beginPath();
                            ctx.ellipse(obstacle.x + obstacle.width/3, obstacle.y + obstacle.height/3, 4, 4, 0, 0, Math.PI * 2);
                            ctx.ellipse(obstacle.x + 2*obstacle.width/3, obstacle.y + obstacle.height/3, 3, 3, 0, 0, Math.PI * 2);
                            ctx.fill();
                            break;
                            
                        case 'enemy-tank':
                            // Вражеский танк
                            // Корпус
                            ctx.fillStyle = '#8B0000';
                            ctx.fillRect(obstacle.x, obstacle.y + 8, obstacle.width, obstacle.height - 8);
                            
                            // Башня
                            ctx.fillStyle = '#B22222';
                            ctx.fillRect(obstacle.x + 5, obstacle.y, 25, 9);
                            
                            // Пушка
                            ctx.fillStyle = '#2F4F4F';
                            ctx.fillRect(obstacle.x + 30, obstacle.y + 3, 15, 5);
                            
                            // Гусеницы
                            ctx.fillStyle = '#2F4F4F';
                            ctx.fillRect(obstacle.x - 2, obstacle.y + obstacle.height - 4, obstacle.width + 4, 7);
                            break;
                    }
                });
            }
            
            // Проверяем столкновения
            function checkCollisions() {
                for (let obstacle of game.obstacles) {
                    if (tank.x < obstacle.x + obstacle.width &&
                        tank.x + tank.width > obstacle.x &&
                        tank.y < obstacle.y + obstacle.height &&
                        tank.y + tank.height > obstacle.y) {
                        
                        // Столкновение произошло
                        gameOver();
                        break;
                    }
                }
            }
            
            // Обновляем счет
            function updateScore() {
                game.score += 1;
                scoreElement.textContent = game.score;
            }
            
            // Увеличиваем сложность
            function increaseDifficulty() {
                // Увеличиваем скорость каждые 500 очков
                if (game.score % 500 === 0) {
                    game.speed += 0.5;
                }
            }
            
            // Конец игры
            function gameOver() {
                game.isRunning = false;
                
                // Обновляем рекорд
                if (game.score > game.highScore) {
                    game.highScore = game.score;
                    localStorage.setItem('tankDinoHighScore', game.highScore);
                    highScoreElement.textContent = game.highScore;
                }
                
                // Показываем экран окончания игры
                finalScoreElement.textContent = game.score;
                finalHighScoreElement.textContent = game.highScore;
                gameOverScreen.style.display = 'block';
                
                // Останавливаем игровой цикл
                cancelAnimationFrame(game.gameLoopId);
            }
            
            // Обработчики событий
            startBtn.addEventListener('click', initGame);
            restartBtn.addEventListener('click', initGame);
            jumpBtn.addEventListener('click', jump);
            
            // Управление с клавиатуры
            document.addEventListener('keydown', (e) => {
                if (e.code === 'Space') {
                    e.preventDefault();
                    jump();
                }
                
                if (e.code === 'Enter' && !game.isRunning) {
                    initGame();
                }
            });
            
            // Управление касанием
            gameContainer.addEventListener('touchstart', (e) => {
                e.preventDefault();
                
                if (!game.isRunning && startScreen.style.display !== 'none') {
                    initGame();
                } else {
                    jump();
                }
            });
            
            // Управление кликом
            gameContainer.addEventListener('click', () => {
                if (!game.isRunning && startScreen.style.display !== 'none') {
                    initGame();
                } else if (game.isRunning) {
                    jump();
                }
            });
            
            // Показываем начальный экран
            startScreen.style.display = 'flex';
            highScoreElement.textContent = game.highScore;
        });
    </script>
</body>
</html>
